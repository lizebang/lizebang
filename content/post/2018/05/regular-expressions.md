---
title: "Regular Expressions"
slug: regular-expressions
date: 2018-05-10
autoThumbnailImage: false
coverImage: /images/cover.jpeg
metaAlignment: center
categories:
  - skill
tags:
  - skill
  - regular-expressions
keywords:
  - skill
  - regular-expressions
---

[正则表达式](https://zh.wikipedia.org/wiki/正则表达式) 使用单个字符串来描述、匹配一系列匹配某个句法规则的字符串。在很多文本编辑器里，正则表达式通常被用来检索、替换那些匹配某个模式的文本。

<!--more-->

## 字符

1.`A-Za-z0-9` 正则表达式可以包含纯文本。正则表达式是区分字母大小写的。

2.`.` 字符可以匹配任意一个单个的字符，包括 `.` 字符本身，但不含空字符。

3.`[]` 字符可以定义一个字符集合，正则与该集合里的任意一个成员相匹配。

4.`-` 字符可以定义一个字符集合区间。`[0-9]` 就是字符集合区间。

5.`^` 元字符可以用来表明你想对一个字符集合进行取非匹配。

## 元字符

1.`\` 元字符可以作为特殊字符的前缀进行转义。

2.空白元字符 -- `[\b]`、`\f`、`\n`、`\r`、`\t`、`\v`。

| 空白元字符 | 说明                                       |
| :--------- | :----------------------------------------- |
| `[\b]`     | 回退符（回退并删除一个字符，Backspace 键） |
| `\f`       | 换页符                                     |
| `\n`       | 换行符                                     |
| `\r`       | 回车符                                     |
| `\t`       | 制表符（Tab 键）                           |
| `\v`       | 垂直制表符                                 |

`\r\n` 是 Windows 所使用的文本行结束标签。Unix 和 Linux 系统只使用一个换行符来结束一个文本行。

3.字符类 -- 数字元字符、字母数字元字符、空白字符元字符、十六进制和八进制数值。

| 元字符 | 说明                                                                           |
| :----- | :----------------------------------------------------------------------------- |
| `\d`   | 任何一个数字字符（等价于 `[0-9]`）                                             |
| `\D`   | 任何一个非数字字符（等价于 `^[0-9]`）                                          |
| `\w`   | 任何一个字母数字字符（大小写均可）或下划线字符（等价于 `[a-zA-Z0-9_]`）        |
| `\W`   | 任何一个字母数字字符或下划线字符（等价于 `[^a-zA-Z0-9_]`）                     |
| `\s`   | 任何一个空白字符（等价于 `[\f\n\r\t\v]`）                                      |
| `\S`   | 任何一个非空白字符（等价于 `^[\f\n\r\t\v]`）                                   |
| `\x`   | 在正则表达式里，十六进制数值要用前缀 `\x` 来给出。                             |
| `\0`   | 在正则表达式里，八进制数值要用前缀 `\0` 来给出，数值本身可以是两位或三位数字。 |

`[\b]` 退格字符是一个例外，它不在不在 `\s` 和 `\S` 的覆盖范围内。

4.有些正则表达式还支持 POSIX 字符类

| 字符类       | 说明                                                     |
| :----------- | :------------------------------------------------------- |
| `[:alnum:]`  | 任何一个字母或数字（等价于 `[a-zA-Z0-9]`）               |
| `[:alpha:]`  | 任意一个字母（等价于 `[a-zA-Z]`）                        |
| `[:blank:]`  | 空格或制表符（等价于 `[\t ]`）                           |
| `[:cntrl:]`  | ASCII 控制字符（ASCII 0 到 31，再加上 ASCII 127）        |
| `[:digit:]`  | 任何一个数字（等价于 [0-9]）                             |
| `[:graph:]`  | 和 `:print:` 一样，但不包括空格                          |
| `[:lower:]`  | 任何一个小写字母（等价于 `[a-z]`）                       |
| `[:print:]`  | 任何一个可打印字符                                       |
| `[:punct:]`  | 既不属于 `[:alnum:]` 也不属于 `[:cntrl:]` 的任何一个字符 |
| `[:space:]`  | 任何一个空白字符，包括空格（等价于 `[^\f\n\r\t\v ]`）    |
| `[:upper:]`  | 任何一个大写字母（等价于 `[A-Z]`）                       |
| `[:xdigit:]` | 任何一个十六进制数字（等价于 `[a-fA-F0-9]`）             |

> 注意：内层的 `[` 和 `]` 字符是 POSIX 字符类本身的组成部分。

## 重复匹配

1.`+` 匹配前面的子表达式一次或多次。

2.`*` 匹配前面的子表达式零次或多次。

3.`?` 匹配前面的子表达式零次或一次，或指明一个非贪婪限定符

| 贪婪型元字符 | 懒惰型元字符 |
| :----------: | :----------: |
|     `*`      |     `*?`     |
|     `+`      |     `+?`     |
|     `{}`     |    `{}?`     |

4.`{}` 匹配前面的子表达式指定次数。`{n}` 匹配确定的 n 次。`{n,}` 至少匹配 n 次。`{n,m}` 最少匹配 n 次且最多匹配 m 次。

## 位置匹配

1.单词边界 -- `\b` 用于匹配单词的开始或结尾。`\B` 用于匹配非单词的开始或结尾。

2.字符串边界 -- `^` 用于匹配字符串开头 ，`$` 用于匹配字符串结尾。

3.有些正则表达式支持分行匹配模式。使用 `?m` 让正则表达式将行分隔符当作字符串分隔符来对待。使用时，`(?m)` 必须出现在整个模式的最前面。

## 子表达式

1.子表达式表示一个更大的表达式的一部分，必须使用 `()` 括起来。

2.`|` 字符是正则表达式里的 _或_ 操作符。

3.允许在子表达式中嵌套子表达式。

## 回溯引用

1.`\x` 表示第 x 个子表达式所匹配到的内容。

> 注意：回溯引用只能用来引用模式里的子表达式。

回溯引用匹配通常从 1 开始计数，有些实现中用 `\0` 表示整个正则表达式。

2.替换操作需要用到两个正则表达式，一个用来给出搜索模式，另一个用来给出匹配文本的替换模式。在替换模式中，使用 `$x` 表示第 x 个子表达式所匹配到的内容。

在有些正则表达式的实现中，替换操作配合特殊的元字符可以完成大小写的转换。

| 元字符 | 说明                                         |
| :----- | :------------------------------------------- |
| `\L`   | 把 `\L` 到 `\E` 之间的所有字符全部转换成小写 |
| `\U`   | 把 `\U` 到 `\E` 之间的所有字符全部转换成大写 |
| `\E`   | 结束 `\L` 或 `\U` 的转换                     |
| `\l`   | 把下一个字符转换成小写                       |
| `\u`   | 把下一个字符转换成大写                       |

## 前后查找

> 注意：前后查找匹配本身其实是有返回结果的，只是这个结果的字节长度为 0。因此，前后查找操作也被称为 _零宽度匹配操作_ 。

1.`(?=xxx)` 正向前匹配，后面字符串满足表达式 `xxx`。

2.`(?<=xxx)` 正向后匹配，前面字符串满足表达式 `xxx`。

3.`(?!xxx)` 负向前匹配，后面字符串不能满足表达式 `xxx`。

4.`(?<!xxx)` 负向后匹配，前面字符串不能满足表达式 `xxx`。

## 嵌入条件

> 警告：并非所有的正则表达式实现都支持条件处理。

1.回溯引用条件 `(?(n)xxx|yyy)`

`(?(n)xxx|yyy)` 表示第 n 个回溯引用存在，则使用 `xxx` 继续进行匹配，否则使用 `yyy` 继续进行匹配。

2.前后查找条件 `(?(?=xxx)xxxyyy)`

`(?(?=xxx)xxxyyy)` 表示后面字符串满足 `xxx`，则使用 `yyy` 继续进行匹配。

## Reference

- [正则表达式（维基百科）](https://zh.wikipedia.org/wiki/正则表达式)
- [ICU User Guide](http://userguide.icu-project.org/strings/regexp)
- [正则表达式必知必会（修订版）](http://www.ituring.com.cn/book/1585)
- [Sams Teach Yourself Regular Expressions in 10 Minutes](http://forums.forta.com/books/0672325667/)
